Скрипт для сжатия больших таблиц в Postgresql
- определяет функцию shrink_large_tables (дата,размер,трунк)
где:
    дата - граница для таблиц с полем timestamp до которой будут удалены записи
    размер - максимальный суммарный размер таблицы для очистки в байтах
    трунк - признак использовать truncate таблиц, вместо удаления

пример вызова 
    SELECT shrink_large_tables('2021-07-30 23:00:00', 20971520, true) 